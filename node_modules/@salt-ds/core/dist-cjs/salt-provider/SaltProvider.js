'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var jsxRuntime = require('react/jsx-runtime');
var styles = require('@salt-ds/styles');
var window = require('@salt-ds/window');
var clsx = require('clsx');
var React = require('react');
require('../aria-announcer/AriaAnnouncerContext.js');
require('../utils/useFloatingUI/useFloatingUI.js');
require('../utils/useId.js');
var useIsomorphicLayoutEffect = require('../utils/useIsomorphicLayoutEffect.js');
var ViewportProvider = require('../viewport/ViewportProvider.js');
require('../accordion/AccordionGroup.js');
require('../accordion/AccordionPanel.js');
require('../accordion/Accordion.js');
require('../accordion/AccordionHeader.js');
require('../avatar/Avatar.js');
require('../badge/Badge.js');
require('../banner/Banner.js');
require('../banner/BannerActions.js');
require('../banner/BannerContent.js');
require('../border-item/BorderItem.js');
require('../border-layout/BorderLayout.js');
var Breakpoints = require('../breakpoints/Breakpoints.js');
var BreakpointProvider = require('../breakpoints/BreakpointProvider.js');
require('../button/Button.js');
require('../card/Card.js');
require('../checkbox/Checkbox.js');
require('../checkbox/CheckboxGroup.js');
require('@salt-ds/icons');
require('../combo-box/ComboBox.js');
require('../dialog/Dialog.js');
require('../dialog/DialogHeader.js');
require('../dialog/DialogActions.js');
require('../dialog/DialogContent.js');
require('../dialog/DialogContext.js');
require('../dialog/DialogCloseButton.js');
require('../divider/Divider.js');
require('../drawer/Drawer.js');
require('../drawer/DrawerCloseButton.js');
require('../dropdown/Dropdown.js');
require('../file-drop-zone/FileDropZone.js');
require('../file-drop-zone/FileDropZoneIcon.js');
require('../file-drop-zone/FileDropZoneTrigger.js');
require('../flex-item/FlexItem.js');
require('../flex-layout/FlexLayout.js');
require('../flow-layout/FlowLayout.js');
require('../form-field/FormField.js');
require('../form-field-context/FormFieldContext.js');
require('../status-indicator/StatusIndicator.js');
require('../text/Text.js');
require('../text/Code.js');
require('../text/Display.js');
require('../text/Headings.js');
require('../text/Label.js');
require('../text/TextAction.js');
require('../text/TextNotation.js');
require('../grid-item/GridItem.js');
require('../grid-layout/GridLayout.js');
require('../input/Input.js');
require('../interactable-card/InteractableCard.js');
require('../interactable-card/InteractableCardGroup.js');
require('../interactable-card/InteractableCardGroupContext.js');
require('../link/Link.js');
require('../link-card/LinkCard.js');
require('../list-box/ListBox.js');
require('../list-control/ListControlContext.js');
require('@floating-ui/react');
require('../menu/MenuContext.js');
require('../menu/MenuItem.js');
require('../menu/MenuPanel.js');
require('../menu/MenuPanelContext.js');
require('../menu/MenuTriggerContext.js');
require('../menu/MenuGroup.js');
require('../multiline-input/MultilineInput.js');
require('../navigation-item/NavigationItem.js');
require('../option/Option.js');
require('../option/OptionGroup.js');
require('../overlay/OverlayContext.js');
require('../overlay/OverlayPanel.js');
require('../overlay/OverlayPanelCloseButton.js');
require('../overlay/OverlayPanelContent.js');
require('../pagination/Pagination.js');
require('../pagination/Paginator.js');
require('../pagination/CompactInput.js');
require('../pagination/CompactPaginator.js');
require('../pagination/GoToInput.js');
require('../panel/Panel.js');
require('../parent-child-layout/ParentChildLayout.js');
require('../pill/Pill.js');
require('../progress/CircularProgress/CircularProgress.js');
require('../progress/LinearProgress/LinearProgress.js');
require('../radio-button/RadioButton.js');
require('../radio-button/RadioButtonGroup.js');
require('../scrim/Scrim.js');
require('../segmented-button-group/SegmentedButtonGroup.js');
require('../spinner/Spinner.js');
require('../stack-layout/StackLayout.js');
require('../status-adornment/StatusAdornment.js');
require('../toast/Toast.js');
require('../toast/ToastContent.js');
require('../split-layout/SplitLayout.js');
require('../switch/Switch.js');
require('../tag/Tag.js');
require('../toggle-button/ToggleButton.js');
require('../toggle-button-group/ToggleButtonGroup.js');
require('../toggle-button-group/ToggleButtonGroupContext.js');
require('../tooltip/Tooltip.js');
require('../semantic-icon-provider/SemanticIconProvider.js');
var AriaAnnouncerProvider = require('../aria-announcer/AriaAnnouncerProvider.js');
var SaltProvider$1 = require('./SaltProvider.css.js');

const DEFAULT_DENSITY = "medium";
const DEFAULT_THEME_NAME = "salt-theme";
const DEFAULT_THEME_NAME_NEXT = "salt-theme-next";
const DEFAULT_MODE = "light";
const DEFAULT_CORNER = "sharp";
const DEFAULT_HEADING_FONT = "Open Sans";
const DEFAULT_ACCENT = "blue";
const DEFAULT_ACTION_FONT = "Open Sans";
const DensityContext = React.createContext(DEFAULT_DENSITY);
const ThemeContext = React.createContext({
  theme: "",
  mode: DEFAULT_MODE,
  themeNext: false,
  corner: DEFAULT_CORNER,
  UNSTABLE_corner: DEFAULT_CORNER,
  headingFont: DEFAULT_HEADING_FONT,
  UNSTABLE_headingFont: DEFAULT_HEADING_FONT,
  accent: DEFAULT_ACCENT,
  UNSTABLE_accent: DEFAULT_ACCENT,
  actionFont: DEFAULT_ACTION_FONT,
  UNSTABLE_actionFont: DEFAULT_ACTION_FONT
});
const BreakpointContext = React.createContext(Breakpoints.DEFAULT_BREAKPOINTS);
const getThemeNames = (themeName, themeNext) => {
  if (themeNext) {
    return themeName === DEFAULT_THEME_NAME ? clsx.clsx(DEFAULT_THEME_NAME, DEFAULT_THEME_NAME_NEXT) : clsx.clsx(DEFAULT_THEME_NAME, DEFAULT_THEME_NAME_NEXT, themeName);
  }
  return themeName === DEFAULT_THEME_NAME ? themeName : clsx.clsx(DEFAULT_THEME_NAME, themeName);
};
const createThemedChildren = ({
  children,
  themeName,
  density,
  mode,
  applyClassesTo,
  themeNext,
  corner,
  headingFont,
  accent,
  actionFont
}) => {
  var _a;
  const themeNamesString = getThemeNames(themeName, themeNext);
  const themeNextProps = {
    "data-corner": corner,
    "data-heading-font": headingFont,
    "data-accent": accent,
    "data-action-font": actionFont
  };
  if (applyClassesTo === "root") {
    return children;
  }
  if (applyClassesTo === "child") {
    if (React.isValidElement(children)) {
      return React.cloneElement(children, {
        className: clsx.clsx(
          (_a = children.props) == null ? void 0 : _a.className,
          themeNamesString,
          `salt-density-${density}`
        ),
        "data-mode": mode,
        ...themeNext ? themeNextProps : {}
      });
    }
    console.warn(
      `
SaltProvider can only apply CSS classes for theming to a single nested child element of the SaltProvider.
        Either wrap elements with a single container or consider removing the applyClassesToChild prop, in which case a
        div element will wrap your child elements`
    );
    return children;
  }
  return /* @__PURE__ */ jsxRuntime.jsx("div", {
    className: clsx.clsx(
      "salt-provider",
      themeNamesString,
      `salt-density-${density}`
    ),
    "data-mode": mode,
    ...themeNext ? themeNextProps : {},
    children
  });
};
function InternalSaltProvider({
  applyClassesTo: applyClassesToProp,
  children,
  density: densityProp,
  theme: themeProp,
  mode: modeProp,
  breakpoints: breakpointsProp,
  themeNext,
  corner: cornerProp,
  headingFont: headingFontProp,
  accent: accentProp,
  actionFont: actionFontProp
}) {
  var _a, _b, _c, _d, _e;
  const inheritedDensity = React.useContext(DensityContext);
  const {
    theme: inheritedTheme,
    mode: inheritedMode,
    window: inheritedWindow,
    corner: inheritedCorner,
    headingFont: inheritedHeadingFont,
    accent: inheritedAccent,
    actionFont: inheritedActionFont
  } = React.useContext(ThemeContext);
  const isRootProvider = inheritedTheme === void 0 || inheritedTheme === "";
  const density = (_a = densityProp != null ? densityProp : inheritedDensity) != null ? _a : DEFAULT_DENSITY;
  const themeName = themeProp != null ? themeProp : inheritedTheme === "" ? DEFAULT_THEME_NAME : inheritedTheme;
  const mode = modeProp != null ? modeProp : inheritedMode;
  const breakpoints = breakpointsProp != null ? breakpointsProp : Breakpoints.DEFAULT_BREAKPOINTS;
  const corner = (_b = cornerProp != null ? cornerProp : inheritedCorner) != null ? _b : DEFAULT_CORNER;
  const headingFont = (_c = headingFontProp != null ? headingFontProp : inheritedHeadingFont) != null ? _c : DEFAULT_HEADING_FONT;
  const accent = (_d = accentProp != null ? accentProp : inheritedAccent) != null ? _d : DEFAULT_ACCENT;
  const actionFont = (_e = actionFontProp != null ? actionFontProp : inheritedActionFont) != null ? _e : DEFAULT_ACTION_FONT;
  const applyClassesTo = applyClassesToProp != null ? applyClassesToProp : isRootProvider ? "root" : "scope";
  const targetWindow = window.useWindow();
  styles.useComponentCssInjection({
    testId: "salt-provider",
    css: SaltProvider$1,
    window: targetWindow
  });
  const themeContextValue = React.useMemo(
    () => ({
      theme: themeName,
      mode,
      window: targetWindow,
      themeNext: Boolean(themeNext),
      corner,
      headingFont,
      accent,
      actionFont,
      UNSTABLE_corner: corner,
      UNSTABLE_headingFont: headingFont,
      UNSTABLE_accent: accent,
      UNSTABLE_actionFont: actionFont
    }),
    [
      themeName,
      mode,
      targetWindow,
      themeNext,
      corner,
      headingFont,
      accent,
      actionFont
    ]
  );
  const themedChildren = createThemedChildren({
    children,
    themeName,
    density,
    mode,
    applyClassesTo,
    themeNext,
    corner,
    headingFont,
    accent,
    actionFont
  });
  useIsomorphicLayoutEffect.useIsomorphicLayoutEffect(() => {
    const themeNamesString = getThemeNames(themeName, themeNext);
    const themeNames = themeNamesString.split(" ");
    if (applyClassesTo === "root" && targetWindow) {
      if (inheritedWindow !== targetWindow) {
        targetWindow.document.documentElement.classList.add(
          ...themeNames,
          `salt-density-${density}`
        );
        targetWindow.document.documentElement.dataset.mode = mode;
        if (themeNext) {
          targetWindow.document.documentElement.dataset.corner = corner;
          targetWindow.document.documentElement.dataset.headingFont = headingFont;
          targetWindow.document.documentElement.dataset.accent = accent;
          targetWindow.document.documentElement.dataset.actionFont = actionFont;
        }
      } else {
        console.warn(
          "SaltProvider can only apply CSS classes to the root if it is the root level SaltProvider."
        );
      }
    }
    return () => {
      if (applyClassesTo === "root" && targetWindow) {
        targetWindow.document.documentElement.classList.remove(
          ...themeNames,
          `salt-density-${density}`
        );
        targetWindow.document.documentElement.dataset.mode = void 0;
        if (themeNext) {
          delete targetWindow.document.documentElement.dataset.corner;
          delete targetWindow.document.documentElement.dataset.headingFont;
          delete targetWindow.document.documentElement.dataset.accent;
          delete targetWindow.document.documentElement.dataset.actionFont;
        }
      }
    };
  }, [
    applyClassesTo,
    density,
    mode,
    themeName,
    targetWindow,
    inheritedWindow,
    themeNext,
    corner,
    headingFont,
    accent,
    actionFont
  ]);
  const matchedBreakpoints = BreakpointProvider.useMatchedBreakpoints(breakpoints);
  const saltProvider = /* @__PURE__ */ jsxRuntime.jsx(DensityContext.Provider, {
    value: density,
    children: /* @__PURE__ */ jsxRuntime.jsx(ThemeContext.Provider, {
      value: themeContextValue,
      children: /* @__PURE__ */ jsxRuntime.jsx(BreakpointProvider.BreakpointProvider, {
        matchedBreakpoints,
        children: /* @__PURE__ */ jsxRuntime.jsx(BreakpointContext.Provider, {
          value: breakpoints,
          children: /* @__PURE__ */ jsxRuntime.jsx(ViewportProvider.ViewportProvider, {
            children: themedChildren
          })
        })
      })
    })
  });
  if (isRootProvider) {
    return /* @__PURE__ */ jsxRuntime.jsx(AriaAnnouncerProvider.AriaAnnouncerProvider, {
      children: saltProvider
    });
  }
  return saltProvider;
}
function SaltProvider({
  enableStyleInjection,
  ...restProps
}) {
  return /* @__PURE__ */ jsxRuntime.jsx(styles.StyleInjectionProvider, {
    value: enableStyleInjection,
    children: /* @__PURE__ */ jsxRuntime.jsx(InternalSaltProvider, {
      ...restProps
    })
  });
}
function SaltProviderNext({
  enableStyleInjection,
  ...restProps
}) {
  return /* @__PURE__ */ jsxRuntime.jsx(styles.StyleInjectionProvider, {
    value: enableStyleInjection,
    children: /* @__PURE__ */ jsxRuntime.jsx(InternalSaltProvider, {
      ...restProps,
      themeNext: true
    })
  });
}
const UNSTABLE_SaltProviderNext = SaltProviderNext;
const useTheme = () => {
  const { window, ...contextWithoutWindow } = React.useContext(ThemeContext);
  return contextWithoutWindow;
};
function useDensity(density) {
  var _a;
  const densityFromContext = React.useContext(DensityContext);
  return (_a = density != null ? density : densityFromContext) != null ? _a : DEFAULT_DENSITY;
}
const useBreakpoints = () => {
  return React.useContext(BreakpointContext);
};

exports.BreakpointContext = BreakpointContext;
exports.DEFAULT_DENSITY = DEFAULT_DENSITY;
exports.DensityContext = DensityContext;
exports.SaltProvider = SaltProvider;
exports.SaltProviderNext = SaltProviderNext;
exports.ThemeContext = ThemeContext;
exports.UNSTABLE_SaltProviderNext = UNSTABLE_SaltProviderNext;
exports.useBreakpoints = useBreakpoints;
exports.useDensity = useDensity;
exports.useTheme = useTheme;
//# sourceMappingURL=SaltProvider.js.map
