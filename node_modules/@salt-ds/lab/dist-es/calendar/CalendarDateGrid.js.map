{"version":3,"file":"CalendarDateGrid.js","sources":["../src/calendar/CalendarDateGrid.tsx"],"sourcesContent":["import { type DateValue, isSameMonth } from \"@internationalized/date\";\nimport { makePrefixer, useIsomorphicLayoutEffect } from \"@salt-ds/core\";\nimport {\n  type ComponentPropsWithoutRef,\n  type FocusEventHandler,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { useCalendarContext } from \"./internal/CalendarContext\";\nimport {\n  CalendarMonth,\n  type CalendarMonthProps,\n} from \"./internal/CalendarMonth\";\n\nimport { useComponentCssInjection } from \"@salt-ds/styles\";\nimport { useWindow } from \"@salt-ds/window\";\nimport calendarDateGridCss from \"./CalendarDateGrid.css\";\nimport { formatDate, monthDiff } from \"./internal/utils\";\n\nexport interface CalendarDateGridProps extends ComponentPropsWithoutRef<\"div\"> {\n  /**\n   * Props getter to pass to each CalendarMonth element\n   */\n  getCalendarMonthProps?: (date: DateValue) => Omit<CalendarMonthProps, \"date\">;\n}\n\nfunction getMonths(month: DateValue) {\n  return [month.subtract({ months: 1 }), month, month.add({ months: 1 })];\n}\n\nconst withBaseName = makePrefixer(\"saltCalendarDateGrid\");\n\nexport const CalendarDateGrid = forwardRef<\n  HTMLDivElement,\n  CalendarDateGridProps\n>(function CalendarDateGrid(props, ref) {\n  const {\n    onFocus,\n    onBlur,\n    getCalendarMonthProps = () => undefined,\n    ...rest\n  } = props;\n\n  const targetWindow = useWindow();\n  useComponentCssInjection({\n    testId: \"salt-calendar-date-grid\",\n    css: calendarDateGridCss,\n    window: targetWindow,\n  });\n\n  const {\n    state: { visibleMonth, locale },\n    helpers: { setCalendarFocused },\n  } = useCalendarContext();\n  const containerRef = useRef<HTMLDivElement>(null);\n  const diffIndex = (a: DateValue, b: DateValue) => monthDiff(a, b);\n\n  const { current: baseIndex } = useRef(visibleMonth);\n\n  useIsomorphicLayoutEffect(() => {\n    if (containerRef.current) {\n      containerRef.current.style.transform = `translate3d(${\n        diffIndex(baseIndex, visibleMonth) * -101 // needs to be higher than 100% so the next month doesn't show on the edges\n      }%, 0, 0)`;\n    }\n  });\n\n  const [months, setMonths] = useState(() => getMonths(visibleMonth));\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: uses formatData to change visibleMonth into string\n  useEffect(() => {\n    setMonths((oldMonths) => {\n      const newMonths = getMonths(visibleMonth).filter((month) => {\n        return !oldMonths.find((oldMonth) => isSameMonth(oldMonth, month));\n      });\n\n      return oldMonths.concat(newMonths);\n    });\n    setMonths(getMonths(visibleMonth));\n    return undefined;\n  }, [formatDate(visibleMonth, locale)]);\n\n  const handleFocus: FocusEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      setCalendarFocused(true);\n      onFocus?.(event);\n    },\n    [setCalendarFocused, onFocus],\n  );\n\n  const handleBlur: FocusEventHandler<HTMLDivElement> = useCallback(\n    (event) => {\n      setCalendarFocused(false);\n      onBlur?.(event);\n    },\n    [setCalendarFocused, onBlur],\n  );\n\n  return (\n    <div\n      className={withBaseName()}\n      tabIndex={-1} // https://bugzilla.mozilla.org/show_bug.cgi?id=1069739\n      style={{\n        overflowX: \"hidden\",\n        position: \"relative\",\n      }}\n      ref={ref}\n    >\n      <div\n        className={withBaseName(\"grid\")}\n        ref={containerRef}\n        onBlur={handleBlur}\n        onFocus={handleFocus}\n        {...rest}\n      >\n        {months.map((date, index) => (\n          <div\n            key={formatDate(date, locale)}\n            className={withBaseName(\"slide\")}\n            style={{\n              transform: `translateX(${diffIndex(date, baseIndex) * -101}%)`,\n            }}\n            aria-hidden={index !== 1 ? \"true\" : undefined}\n          >\n            <CalendarMonth {...getCalendarMonthProps(date)} date={date} />\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n});\n"],"names":["CalendarDateGrid","calendarDateGridCss"],"mappings":"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"}