{"version":3,"file":"useCalendarDay.js","sources":["../src/calendar/useCalendarDay.ts"],"sourcesContent":["import {\n  type DateValue,\n  isSameDay,\n  isSameMonth,\n  isToday,\n} from \"@internationalized/date\";\nimport {\n  type ComponentPropsWithoutRef,\n  type FocusEventHandler,\n  type KeyboardEventHandler,\n  type MouseEventHandler,\n  type RefObject,\n  useEffect,\n} from \"react\";\nimport { useCalendarContext } from \"./internal/CalendarContext\";\nimport { useFocusManagement } from \"./internal/useFocusManagement\";\nimport { useCalendarSelectionDay } from \"./useCalendarSelection\";\n\n/**\n * Interface representing the status of a day in the Calendar.\n */\nexport interface DayStatus {\n  /**\n   * If `true`, the day is out of the selectable range.\n   */\n  outOfRange?: boolean;\n  /**\n   * If `true`, the day is selected.\n   */\n  selected?: boolean;\n  /**\n   * If `true`, the day is today.\n   */\n  today?: boolean;\n  /**\n   * If set, the day is unselectable with a reason.\n   */\n  unselectable?: string | false;\n  /**\n   * If set, the day is highlighted with a reason.\n   */\n  highlighted?: string | false;\n  /**\n   * If `true`, the day is focused.\n   */\n  focused?: boolean;\n  /**\n   * If `true`, the day is disabled.\n   */\n  disabled?: boolean;\n  /**\n   * If `true`, the day is hidden.\n   */\n  hidden?: boolean;\n}\n\n/**\n * UseCalendar hook props to return a calendar day's status\n */\nexport interface useCalendarDayProps {\n  /**\n   * The date of the calendar day.\n   */\n  date: DateValue;\n  /**\n   * The month of the calendar day.\n   */\n  month: DateValue;\n}\n\nexport function useCalendarDay(\n  { date, month }: useCalendarDayProps,\n  ref: RefObject<HTMLElement>,\n) {\n  const {\n    state: {\n      focusedDate,\n      hideOutOfRangeDates,\n      calendarFocused,\n      locale,\n      timeZone,\n    },\n    helpers: {\n      isDayUnselectable,\n      isDaySelectable,\n      isDayHighlighted,\n      isDayDisabled,\n      isOutsideAllowedMonths,\n    },\n  } = useCalendarContext();\n  const selectionManager = useCalendarSelectionDay({ date });\n  const focusManager = useFocusManagement({ date, locale });\n\n  const handleClick: MouseEventHandler<HTMLButtonElement> = (event) => {\n    selectionManager?.handleClick(event);\n    focusManager.handleClick(event);\n  };\n\n  const handleKeyDown: KeyboardEventHandler<HTMLButtonElement> = (event) => {\n    focusManager.handleKeyDown(event);\n    selectionManager?.handleKeyDown(event);\n  };\n\n  const handleFocus: FocusEventHandler<HTMLButtonElement> = (event) => {\n    focusManager.handleFocus(event);\n  };\n\n  const handleMouseOver: MouseEventHandler<HTMLButtonElement> = (event) => {\n    selectionManager.handleMouseOver?.(event);\n  };\n\n  const eventHandlers = {\n    onClick: handleClick,\n    onKeyDown: handleKeyDown,\n    onFocus: handleFocus,\n    onMouseOver: handleMouseOver,\n  };\n\n  const outOfRange = !isSameMonth(date, month);\n  const focused =\n    focusedDate &&\n    isSameDay(date, focusedDate) &&\n    calendarFocused &&\n    !outOfRange;\n  const tabIndex =\n    focusedDate && isSameDay(date, focusedDate) && !outOfRange ? 0 : -1;\n  const today = isToday(date, timeZone);\n\n  const unselectableReason = isDayUnselectable(date) || isDayDisabled(date);\n  const highlightedReason = isDayHighlighted(date);\n\n  const disabled =\n    isDayDisabled(date) ||\n    (outOfRange && isOutsideAllowedMonths(date)) ||\n    (isDaySelectable && !isDaySelectable(date));\n  const unselectable = Boolean(unselectableReason);\n  const highlighted = Boolean(highlightedReason);\n  const hidden = hideOutOfRangeDates && outOfRange;\n\n  useEffect(() => {\n    if (focused) {\n      ref.current?.focus({ preventScroll: true });\n    }\n  }, [ref, focused]);\n\n  return {\n    status: {\n      outOfRange,\n      today,\n      unselectable,\n      focused,\n      hidden,\n      disabled,\n      highlighted,\n      ...selectionManager.status,\n    } as DayStatus,\n    dayProps: {\n      tabIndex,\n      \"aria-current\": today ? \"date\" : undefined,\n      \"aria-hidden\": hidden ? \"true\" : undefined,\n      ...eventHandlers,\n      ...selectionManager.dayProps,\n    } as ComponentPropsWithoutRef<\"button\">,\n    unselectableReason,\n    highlightedReason,\n    locale,\n    timeZone,\n  };\n}\n"],"names":[],"mappings":";;;;;;AAsEO,SAAS,cACd,CAAA,EAAE,IAAM,EAAA,KAAA,IACR,GACA,EAAA;AACA,EAAM,MAAA;AAAA,IACJ,KAAO,EAAA;AAAA,MACL,WAAA;AAAA,MACA,mBAAA;AAAA,MACA,eAAA;AAAA,MACA,MAAA;AAAA,MACA,QAAA;AAAA,KACF;AAAA,IACA,OAAS,EAAA;AAAA,MACP,iBAAA;AAAA,MACA,eAAA;AAAA,MACA,gBAAA;AAAA,MACA,aAAA;AAAA,MACA,sBAAA;AAAA,KACF;AAAA,MACE,kBAAmB,EAAA,CAAA;AACvB,EAAA,MAAM,gBAAmB,GAAA,uBAAA,CAAwB,EAAE,IAAA,EAAM,CAAA,CAAA;AACzD,EAAA,MAAM,YAAe,GAAA,kBAAA,CAAmB,EAAE,IAAA,EAAM,QAAQ,CAAA,CAAA;AAExD,EAAM,MAAA,WAAA,GAAoD,CAAC,KAAU,KAAA;AACnE,IAAA,gBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,gBAAA,CAAkB,WAAY,CAAA,KAAA,CAAA,CAAA;AAC9B,IAAA,YAAA,CAAa,YAAY,KAAK,CAAA,CAAA;AAAA,GAChC,CAAA;AAEA,EAAM,MAAA,aAAA,GAAyD,CAAC,KAAU,KAAA;AACxE,IAAA,YAAA,CAAa,cAAc,KAAK,CAAA,CAAA;AAChC,IAAA,gBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,gBAAA,CAAkB,aAAc,CAAA,KAAA,CAAA,CAAA;AAAA,GAClC,CAAA;AAEA,EAAM,MAAA,WAAA,GAAoD,CAAC,KAAU,KAAA;AACnE,IAAA,YAAA,CAAa,YAAY,KAAK,CAAA,CAAA;AAAA,GAChC,CAAA;AAEA,EAAM,MAAA,eAAA,GAAwD,CAAC,KAAU,KAAA;AA3G3E,IAAA,IAAA,EAAA,CAAA;AA4GI,IAAA,CAAA,EAAA,GAAA,gBAAA,CAAiB,oBAAjB,IAAmC,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,IAAA,CAAA,gBAAA,EAAA,KAAA,CAAA,CAAA;AAAA,GACrC,CAAA;AAEA,EAAA,MAAM,aAAgB,GAAA;AAAA,IACpB,OAAS,EAAA,WAAA;AAAA,IACT,SAAW,EAAA,aAAA;AAAA,IACX,OAAS,EAAA,WAAA;AAAA,IACT,WAAa,EAAA,eAAA;AAAA,GACf,CAAA;AAEA,EAAA,MAAM,UAAa,GAAA,CAAC,WAAY,CAAA,IAAA,EAAM,KAAK,CAAA,CAAA;AAC3C,EAAA,MAAM,UACJ,WACA,IAAA,SAAA,CAAU,MAAM,WAAW,CAAA,IAC3B,mBACA,CAAC,UAAA,CAAA;AACH,EAAM,MAAA,QAAA,GACJ,eAAe,SAAU,CAAA,IAAA,EAAM,WAAW,CAAK,IAAA,CAAC,aAAa,CAAI,GAAA,CAAA,CAAA,CAAA;AACnE,EAAM,MAAA,KAAA,GAAQ,OAAQ,CAAA,IAAA,EAAM,QAAQ,CAAA,CAAA;AAEpC,EAAA,MAAM,kBAAqB,GAAA,iBAAA,CAAkB,IAAI,CAAA,IAAK,cAAc,IAAI,CAAA,CAAA;AACxE,EAAM,MAAA,iBAAA,GAAoB,iBAAiB,IAAI,CAAA,CAAA;AAE/C,EAAM,MAAA,QAAA,GACJ,aAAc,CAAA,IAAI,CACjB,IAAA,UAAA,IAAc,sBAAuB,CAAA,IAAI,CACzC,IAAA,eAAA,IAAmB,CAAC,eAAA,CAAgB,IAAI,CAAA,CAAA;AAC3C,EAAM,MAAA,YAAA,GAAe,QAAQ,kBAAkB,CAAA,CAAA;AAC/C,EAAM,MAAA,WAAA,GAAc,QAAQ,iBAAiB,CAAA,CAAA;AAC7C,EAAA,MAAM,SAAS,mBAAuB,IAAA,UAAA,CAAA;AAEtC,EAAA,SAAA,CAAU,MAAM;AA3IlB,IAAA,IAAA,EAAA,CAAA;AA4II,IAAA,IAAI,OAAS,EAAA;AACX,MAAA,CAAA,EAAA,GAAA,GAAA,CAAI,OAAJ,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAa,KAAM,CAAA,EAAE,eAAe,IAAK,EAAA,CAAA,CAAA;AAAA,KAC3C;AAAA,GACC,EAAA,CAAC,GAAK,EAAA,OAAO,CAAC,CAAA,CAAA;AAEjB,EAAO,OAAA;AAAA,IACL,MAAQ,EAAA;AAAA,MACN,UAAA;AAAA,MACA,KAAA;AAAA,MACA,YAAA;AAAA,MACA,OAAA;AAAA,MACA,MAAA;AAAA,MACA,QAAA;AAAA,MACA,WAAA;AAAA,MACA,GAAG,gBAAiB,CAAA,MAAA;AAAA,KACtB;AAAA,IACA,QAAU,EAAA;AAAA,MACR,QAAA;AAAA,MACA,cAAA,EAAgB,QAAQ,MAAS,GAAA,KAAA,CAAA;AAAA,MACjC,aAAA,EAAe,SAAS,MAAS,GAAA,KAAA,CAAA;AAAA,MACjC,GAAG,aAAA;AAAA,MACH,GAAG,gBAAiB,CAAA,QAAA;AAAA,KACtB;AAAA,IACA,kBAAA;AAAA,IACA,iBAAA;AAAA,IACA,MAAA;AAAA,IACA,QAAA;AAAA,GACF,CAAA;AACF;;;;"}